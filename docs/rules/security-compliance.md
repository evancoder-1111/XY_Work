# 安全与合规（Security & Compliance）

## 1. 身份与访问（Identity & Access）
- 认证：SSO（OAuth2/SAML）+ JWT；Token 短期有效 + 刷新
- 授权：RBAC（基于角色的访问控制）；敏感操作二次确认
- **密码策略**：
  - 最小长度 10 位
  - 包含大小写字母、数字和特殊字符
  - 定期密码更新（如 90 天）
  - 密码历史记录和重复检测
- **会话管理**：
  - 会话超时设置（如 30 分钟）
  - 多设备登录限制
  - 会话劫持防护

## 2. 数据安全（Data Security）
- 传输：HTTPS/TLS；HSTS；禁止明文敏感信息
- 存储：敏感字段加密/脱敏；最小化收集与保留
- 日志：避免打印密钥/口令；日志脱敏

## 3. 应用安全（AppSec）
- 输入校验与输出转义；防注入、防 XSS/CSRF
- 依赖漏洞扫描与升级；容器镜像安全基线

## 4. 合规（Compliance）
- 遵循公司制度与国家法律法规（等保/数据合规）
- 第三方服务评估与备案；数据跨境合规审查

## 5. 审计与告警（Audit & Alert）
- 审计日志：谁在何时对何资源做了何操作（Who/When/What）
- 告警：登录异常、权限提升、关键配置变更

## 6. 安全漏洞响应流程

### 6.1 发现与报告
- **内部发现**：通过安全测试、代码审查发现
- **外部报告**：安全研究人员或用户报告
- **报告渠道**：专用安全问题报告平台
- **初步评估**：安全团队 24 小时内进行初步评估

### 6.2 评估与分类
- **严重性分类**：
  - 紧急（P0）：系统级漏洞，影响核心功能或数据安全
  - 高（P1）：重要功能漏洞，可能导致数据泄露或系统损坏
  - 中（P2）：一般功能漏洞，影响系统可用性或性能
  - 低（P3）：小问题，不影响系统安全和功能
- **修复优先级**：基于严重性和影响范围确定

### 6.3 修复与验证
- **修复计划**：制定详细的修复计划和时间表
- **修复开发**：由开发团队实施修复
- **代码审查**：安全团队审查修复代码
- **验证测试**：
  - 功能测试
  - 安全测试
  - 回归测试

### 6.4 披露与总结
- **内部披露**：向相关团队和管理层通报
- **外部披露**：
  - 协调披露原则
  - 提前通知用户
  - 遵循法律要求
- **事后总结**：
  - 根因分析
  - 预防措施
  - 改进流程

## 7. 安全编码实践

### 7.1 前端安全编码
- **XSS 防护**：
  - 使用内容安全策略（CSP）
  - 输入验证和输出编码
  - 使用框架的安全功能（如 React 的 JSX 转义）
- **CSRF 防护**：
  - 使用 CSRF Token
  - 验证 Origin/Referer 头
- **敏感信息保护**：
  - 不在客户端存储敏感信息
  - 不在 URL 中传递敏感信息
- **安全的第三方库**：
  - 定期更新依赖
  - 审查第三方库的安全性

### 7.2 后端安全编码
- **注入防护**：
  - 使用参数化查询
  - 输入验证和过滤
  - 使用 ORM 框架
- **认证与授权**：
  - 实现安全的认证机制
  - 严格的权限检查
  - 最小权限原则
- **错误处理**：
  - 不要在错误响应中泄露敏感信息
  - 实现统一的错误处理机制
- **安全的会话管理**：
  - 安全的 Cookie 设置（HttpOnly, Secure, SameSite）
  - 适当的会话超时

### 7.3 依赖管理
- **依赖扫描**：
  - 使用自动化工具扫描依赖漏洞
  - 定期检查和更新依赖
- **依赖审核**：
  - 审核新引入的依赖
  - 移除未使用的依赖
- **依赖锁定**：
  - 使用 lock 文件锁定依赖版本
  - 避免使用通配符版本

## 8. 安全测试

### 8.1 安全测试类型
- **静态应用安全测试（SAST）**：代码级别的安全分析
- **动态应用安全测试（DAST）**：运行时的安全测试
- **交互式应用安全测试（IAST）**：结合静态和动态测试
- **渗透测试**：模拟攻击者的测试方法
- **依赖扫描**：检查第三方依赖的安全漏洞

### 8.2 安全测试流程
- **计划阶段**：
  - 确定测试范围
  - 制定测试计划
  - 准备测试环境
- **执行阶段**：
  - 运行安全测试工具
  - 手动测试（如渗透测试）
  - 记录发现的问题
- **分析阶段**：
  - 评估问题严重性
  - 验证问题
  - 生成报告
- **修复阶段**：
  - 开发团队修复问题
  - 验证修复
  - 更新文档

### 8.3 安全测试工具
- **SAST 工具**：SonarQube, Checkmarx, Fortify
- **DAST 工具**：OWASP ZAP, Burp Suite
- **依赖扫描工具**：OWASP Dependency-Check, Snyk
- **容器安全工具**：Trivy, Clair

## 9. 安全配置与最佳实践

### 9.1 服务器配置
- **最小化安装**：仅安装必要的服务和组件
- **定期更新**：及时应用安全补丁
- **安全基线**：遵循 CIS 等安全基线
- **防火墙配置**：仅开放必要的端口和服务

### 9.2 数据库配置
- **强密码策略**：为数据库用户设置强密码
- **最小权限**：数据库用户仅授予必要的权限
- **加密存储**：敏感数据加密存储
- **备份策略**：定期备份和测试恢复

### 9.3 云服务配置
- **安全组配置**：限制网络访问
- **IAM 配置**：实施严格的身份和访问管理
- **密钥管理**：安全管理 API 密钥和凭证
- **安全日志**：启用和监控安全日志

## 10. 安全培训与意识

### 10.1 培训计划
- **新员工培训**：安全基础知识
- **定期培训**：安全更新和新威胁
- **专业培训**：针对开发、运维等不同角色的专业安全培训
- **模拟演练**：钓鱼邮件测试、安全事件响应演练

### 10.2 意识提升
- **安全公告**：及时发布安全公告和提醒
- **安全博客**：分享安全知识和最佳实践
- **安全文化**：培养安全第一的文化
- **奖励机制**：鼓励报告安全问题和积极参与安全活动

### 10.3 考核与评估
- **安全知识测试**：定期测试安全知识
- **安全实践评估**：评估团队的安全实践
- **安全绩效**：将安全指标纳入绩效评估
- **持续改进**：基于评估结果持续改进

## 11. 安全合规检查清单

### 11.1 开发阶段检查项
- [ ] 安全需求分析和设计
- [ ] 代码审查（包含安全审查）
- [ ] 静态代码安全分析
- [ ] 依赖扫描
- [ ] 输入验证和输出编码
- [ ] 认证和授权实现
- [ ] 敏感数据处理

### 11.2 部署前检查项
- [ ] 安全配置检查
- [ ] 渗透测试
- [ ] 漏洞扫描
- [ ] 日志和监控配置
- [ ] 备份和恢复测试
- [ ] 安全文档完整性

### 11.3 运维阶段检查项
- [ ] 定期安全更新和补丁管理
- [ ] 安全日志审查
- [ ] 异常行为监控和告警
- [ ] 定期安全评估和测试
- [ ] 安全事件响应演练
- [ ] 合规性审计

